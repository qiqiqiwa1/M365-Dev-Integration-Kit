# user_service.py（新增用户登录功能模块）
def user_login(username, password):
    """
    用户登录功能实现
    :param username: 用户名
    :param password: 密码
    :return: 登录令牌或错误信息
    """
    # 新增密码加密验证（使用bcrypt算法）
    hashed_password = get_hashed_password(username)
    if bcrypt.checkpw(password.encode(), hashed_password):
        # 生成JWT令牌（有效期2小时）
        return generate_jwt_token(username)
    else:
        raise AuthenticationError("Invalid credentials")
